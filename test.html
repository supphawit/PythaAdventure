<html>

<head>

</head>

<body style="background-color: darkslategrey">
  <button type="button" onclick="cancel_animation()">stop</button>
  <canvas id="ctx">
  </canvas>

</body>

<script>
  var canvas = document.querySelector('canvas')
  var ctx = canvas.getContext('2d')

  canvas.width = window.innerWidth
  canvas.height = window.innerHeight

  var playerImg = new Image()
  playerImg.src = 'client/images/player.png'

  function drawFrame(img, frameX, frameY, canvasX, canvasY, width, height) {
    ctx.drawImage(img, frameX * 128, frameY * 128, 128, 128, canvasX, canvasY, width, width)
  }

  const cycleLoop = [0, 1, 2]
  let currentIndex = 0

  function step_intro() {

    setTimeout(function () {

      ctx.clearRect(0, 0, canvas.width, canvas.height)
      drawFrame(playerImg, cycleLoop[currentIndex], 0, 150, 420, 128)
      currentIndex++
      console.log(currentIndex)

      if (currentIndex >= cycleLoop.length - 1) {
        currentIndex = 0
      }
      window.requestAnimationFrame(step_intro)
    }, 250);
  }

  var id = null;

  function start_animation() {
    id = requestAnimationFrame(step_intro);
  }

  function cancel_animation() {
    cancelAnimationFrame(id);
  }
  start_animation()
</script>

</html>